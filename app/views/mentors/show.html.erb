<div class="container padding-top">
  <%#= if policy(Mentor).show? %>
  <div>
    <div class="row user-main-box">
      <% if @mentor.user.photo.attached? %>
        <%= cl_image_tag @mentor.user.photo.key, alt: "avatar-large", class: "avatar-large" %>
      <% else %>
        <img src="https://image.flaticon.com/icons/png/512/194/194937.png" alt="avatar-large" class="avatar-large">
      <% end %>
      <div class="user-main-info">
        <h4><%= @mentor.user.name %></h4>
        <p><%= @mentor.title %></p>
        <p>Consultations: <%= @mentor.consultations.count %></p>
        <div class="stars">
          <% @mentor.average_rating.times do %>
            <i class="fas fa-star"></i>
          <% end %>
          <% (5 - @mentor.average_rating).times do %>
            <i class="far fa-star"></i>
          <% end  %>
          <%= link_to "Reviews", mentor_path(@mentor, :anchor => "reviews") %>
        </div>
      </div>
    </div>
    <div>
      <div class="mentor-description">
        <div id="description">
          <h5>About</h5>
          <p><%= @mentor.description %></p>
        </div>
        <div class="mentor-details">
          <p><strong>Availability: </strong> <%= @mentor.availability %></p>
          <p><strong>Price: ¥</strong><span id="price"><%= @mentor.price %></span>/30min</p>
        </div>
      </div>
    </div>
    <div class="expertise-card">
      <h6>Mentor Expertises</h6>
      <div class="row expetise-tags">
        <% @mentor.tags.each do |tag| %>
          <p class="tag my-2"><strong></strong><%= tag.name %></p>
        <% end  %>
      </div>
    </div>
    <h4>Book this mentor now!</h4>
    <div class="booking-form">
      <div class="row bookin-form-row">
        <div class="col-8">
          <%= render 'consultations/form' %>
        </div>
        <div class="col-4 booking-details">
          <h4>Booking Details</h4>
          <ul>
            <li id="cons-date"><span>Starting on: </span></li>
            <li id="cons-duration"><span>Duration: </span></li>
            <li id="total"><span>Total:</span> ¥0</li>
          </ul>
        </div>
      </div>
    </div>
    <div class="reviews">
      <div  id="reviews">
        <h3>Reviews(<%= @mentor.reviews.count  %>)</h3>
      </div>
      <div class="review-wrap">
        <% if @mentor.reviews.blank? %>
          <p></p>
        <% else %>
          <% @mentor.reviews.order(created_at: :desc).each do |review| %>
            <div class="review-card">
              <div class="user-profile-card">
                <% if review.user.photo.attached? %>
                  <%= cl_image_tag review.user.photo.key, alt: "avatar-large", class: "avatar-small" %>
                <% else %>
                  <img src="https://image.flaticon.com/icons/png/512/194/194937.png" alt="avatar-large" class="avatar-small">
                <% end %>
                <p><%= review.user.name %></p>
              </div>
              <div class="user-review-info">
                <p>"<%= review.content %>"</p>
                <div class="stars">
                  <p>
                    <% if review.rating.nil? %>
                      <p></p>
                    <% else %>
                      <% review.rating.times do %>
                        <i class="fas fa-star"></i>
                      <% end %>
                      <% (5 - review.rating).times do %>
                        <i class="far fa-star"></i>
                      <% end  %>
                    <% end %>
                  </p>
                </div>
              </div>
            </div>
          <% end  %>
        <% end  %>
      </div>
    </div>
  </div>
</div>
